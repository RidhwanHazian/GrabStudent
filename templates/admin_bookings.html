<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Bookings | Grab Student</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

    <!-- Header / Navbar -->
  <header>
      <div class="logo">GRAB STUDENT - Admin</div>
      <nav>
          <ul class="nav-links">
              <li><a href="{{ url_for('admin_dashboard') }}">Dashboard</a></li>
              <li><a href="{{ url_for('admin_bookings') }} " class="active">Manage Bookings</a></li>
              <li><a href="{{ url_for('admin_users') }}">Manage Users/Drivers</a></li>
              <li><a href="{{ url_for('admin_feedbacks') }}">Feedback</a></li> <!-- âœ… New Feedback link -->
              <li><a href="{{ url_for('edit_profile') }}">Edit Profile</a></li>
              <li>
                  <form method="POST" action="{{ url_for('logout') }}" style="display:inline;">
                      <button type="submit" class="logout-btn" onclick="return confirm('Are you sure you want to logout?');">
                          Logout
                      </button>
                  </form>
              </li>
          </ul>
      </nav>
  </header>

    <main>
        <section class="recent-bookings">
            <h2 >All Customer Bookings</h2>
              <form method="GET" action="{{ url_for('admin_bookings') }}" class="filter-form" style=" justify-content: center">
                <label>Status:
                    <select name="status">
                        <option value="">All</option>
                        <option value="Pending" {% if request.args.get('status') == 'Pending' %}selected{% endif %}>Pending</option>
                        <option value="Completed" {% if request.args.get('status') == 'Completed' %}selected{% endif %}>Completed</option>
                        <option value="Cancelled" {% if request.args.get('status') == 'Cancelled' %}selected{% endif %}>Cancelled</option>
                    </select>
                </label>

                <label>Driver:
                    <select name="driver_id">
                        <option value="">All</option>
                        {% for driver in drivers %}
                        <option value="{{ driver.driver_id }}" {% if request.args.get('driver_id') == driver.driver_id|string %}selected{% endif %}>
                            {{ driver.name }}
                        </option>
                        {% endfor %}
                    </select>
                </label>

                <label>Date From:
                    <input type="date" name="date_from" value="{{ request.args.get('date_from') }}">
                </label>

                <label>Date To:
                    <input type="date" name="date_to" value="{{ request.args.get('date_to') }}">
                </label>

                <button type="submit" class="btn">Filter</button>
            </form>
            <table>
                <thead>
                    <tr>
                        <th>Customer</th>
                        <th>Pickup</th>
                        <th>Dropoff</th>
                        <th>Date & Time</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for booking in bookings %}
                    <tr>
                        <td>{{ booking.customer_name }}</td>
                        <td>{{ booking.pickup }}</td>
                        <td>{{ booking.dropoff }}</td>
                        <td>{{ booking.datetime }}</td>
                        <td>{{ booking.status }}</td>
                        <td>
                            <a href="{{ url_for('edit_booking', booking_id=booking.id) }}" class="btn">Edit</a>
                            <form method="POST" action="{{ url_for('delete_booking', booking_id=booking.id) }}" style="display:inline;">
                                <button type="submit" class="delete-btn" onclick="return confirm('Are you sure you want to delete this booking?');">
                                    Delete
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </section>
    </main>

</body>
</html>
